---
title: 1.类加载过程简单介绍
date: 2019-03-10 22:21:09
tags:
  - jvm
categories:
  - JVM学习
---

# 类加载器解析以及阶段分解

java_**类型**_（不涉及对象）加载、连接和初始化都是在**程序运行期间**完成的，这中设计在灵活性上面增加了更多的可能性（例如动态代理）

用来加载类的工具就是类加载器

## 类加载的过程

    1. **加载**： 查找并加载类的二进制文件
    2. **连接**：
        * 验证：确保类加载的正确性
        * 准备：静态变量分配内存，初始默认值
        * 解析：符号引用解析为直接引用
    3. **初始化**：类的静态变量赋予正确初始值
    4. 使用：调用类得相应的方法，开发者最常参与的过程
    5. 类的卸载：内存中去掉（卸载完成中之后，类就不能使用和创建了，因为在内存中该类型
       已经不存在了，想要使用需要重新加载。例如：osgi）

```bash

  public static int a=1;

1. 静态变量a分配内存，初始化默认值为_**0**_
2. 在初始化过程中，为a赋值为1
  
```

### 符号（间接）引用解析直接引用

**符号引用**就是指的字符串，这个字符串中包含足够的信息，用于在实际使用的时候找到相应的类的位置。比如说某个方法的符号引用，如：“java/io/PrintStream.println:(Ljava/lang/String;)V”。里面有类的信息，方法名，方法参数等信息。
**直接引用**就是偏移量，通过偏移量虚拟机可以直接在该类的内存区域中找到方法自己码的起始位置
**符号引用解析为直接引用**：当第一次运行时，要根据字符串的内容，到该类的方法表中搜索这个方法。运行一次之后，符号引用会被替换为直接引用，下次就不用搜索了，直接使用方法区中的直接引用，这就是类加载过程中的链接中的解析。

**注： **
   类加载过程，总体是按照顺序，但并不是严格按照顺序进行的。比如：在加载过程中可能会执行初始化中的某些处理。

## JVM结束生命周期的方法

* System.exit();

* 程序正常结束

* 遇到异常或者错误，异常终止

* 操作系统错误而导致（开发者不可控的因素）
